import com.hiperbou.enigma.*
import org.junit.Test
import kotlin.test.assertEquals

class EnigmaMachinesTests {
    fun defaultMachine(plugboardConfig:String = ""): EnigmaMachine {
        return EnigmaM3(reflectorB, rI, rII, rIII, plugboardConfig)
    }

    @Test
    fun helloWorld() {
        val encoded = defaultMachine().encode("HELLOWORLD")
        val decoded = defaultMachine().encode(encoded)

        assertEquals("ILBDAAMTAZ", encoded)
        assertEquals("HELLOWORLD", decoded)
    }

    @Test
    fun plugboardTest() {
        val plugboardConfig = "AB CD EF GH IJ KL MN OP QR ST"

        val encoded = defaultMachine(plugboardConfig).encode("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
        val decoded = defaultMachine(plugboardConfig).encode(encoded)

        assertEquals("BCIAHMSKJUPDSQCVOGHSSMDENF", encoded)
        assertEquals("ABCDEFGHIJKLMNOPQRSTUVWXYZ", decoded)
    }

    @Test
    fun simpleEncodingTest(){
        val machine = defaultMachine()

        assertEquals("BDZGO", machine.encode("AAAAA")) //"BDZGO"
        assertEquals("YJIFK", machine.encode("BBBBB")) //"AJLCS"
        assertEquals("WKQOY", machine.encode("CCCCC")) //"QREBN"
        assertEquals("SAMIG", machine.encode("DDDDD")) //"MAJLI"
    }

    @Test
    fun doubleStepTest() {
        val machine = defaultMachine().setKey("QET")

        fun getRotorsPosition():String {
            return machine.getRotorsPosition()
        }
        assertEquals("QET", getRotorsPosition())

        assertEquals("IHRWF", machine.encode("AAAAA"))
        assertEquals("RGY", getRotorsPosition())

        assertEquals("YLGKK", machine.encode("BBBBB"))
        assertEquals("RGD", getRotorsPosition())

        assertEquals("HAAWW", machine.encode("CCCCC"))
        assertEquals("RGI", getRotorsPosition())

        assertEquals("ISPZL", machine.encode("DDDDD"))
        assertEquals("RGN", getRotorsPosition())
    }

    @Test
    fun innerRingTest() {
        val machine = defaultMachine()
        machine.setInnerRingOffset(1,1,2)
        assertEquals("UBDZG", machine.encode("AAAAA"))
        machine.setKey("AAA")
        assertEquals("OMAJLI", machine.encode("DDDDDD"))
    }

    @Test
    fun innerRingTest2() {
        val machine = defaultMachine()
        machine.setInnerRingOffset(1,2,2)

        assertEquals("GFEBR", machine.encode("AAAAA"))
        machine.setKey("AAA")
        assertEquals("YRHQVR", machine.encode("DDDDDD"))

        machine.setInnerRingOffset(26,2,1)
        machine.setKey("AAA")

        assertEquals("ONGIQ", machine.encode("AAAAA"))
        machine.setKey("AAA")
        assertEquals("MKWXIE", machine.encode("DDDDDD"))
    }

    @Test
    fun FullRotationsTest() {
        val repetitions = 26*25*26
        val a = (0..repetitions).map { "A" }.joinToString("")

        val encoded = defaultMachine().encode(a)
        val decoded = defaultMachine().encode(encoded)

        assertEquals("BDZGOWCXLTKSBTMCDLPBMUQOFXYHCXTGYJFLINHNXSHIUNTHEORXPQPKOVHCBUBTZSZSOOSTGOTFSODBBZZLXLCYZXIFGWFDZEEQIBMGFJBWZFCKPFMGBXQCIVIBBRNCOCJUVYDKMVJPFMDRMTGLWFOZLXGJEYYQPVPBWNCKVKLZTCBDLDCTSNRCOOVPTGBVBBISGJSOYHDENCTNUUKCUGHREVWBDJCTQXXOGLEBZMDBRZOSXDTZSZBGDCFPRBZYQGSNCCHGYEWOHVJBYZGKDGYNNEUJIWCTYCYTUUMBOYVUNNQUKKSOBSCORSUOSCNVROQLHEUDSUKYMIGIBSXPIHNTUVGGHIFQTGZXLGYQCNVNSRCLVPYOSVRBKCEXRNLGDYWEBFXIVKKTUGKPVMZOTUOGMHHZDREKJHLEFKKPOXLWBWVBYUKDTQUHDQTREVRQJMQWNDOVWLJHCCXCFXRPPXMSJEZCJUFTBRZZMCSSNJNYLCGLOYCITVYQXPDIYFGEFYVXSXHKEGXKMMDSWBCYRKIZOCGMFDDTMWZTLSSFLJMOOLUUQJMIJSCIQVRUISTLTGNCLGKIKTZHRXENRXJHYZTLXICWWMYWXDYIBLERBFLWJQYWONGIQQCUUQTPPHBIEHTUVGCEGPEYMWICGKWJCUFKLUIDMJDIVPJDMPGQPWITKGVIBOOMTNDUHQPHGSQRJRNOOVPWMDNXLLVFIIMKIEYIZMQUWYDPOULTUWBUKVMMWRLQLQSQPEUGJRCXZWPFYIYYBWLOEWROUVKPOZTCEUWTFJZQWPBQLDTTSRMDFLGXBXZRYQKDGJRZEZMKHJNQYPDJWCJFJLFNTRSNCNLGSSGJCDLXUJBLTFGKHJGQUNCQDESTXZDTUWJBROVGJSFRMRWEXTVHIITRFYGPDUFBMHFGIICNXBKEFRQPGDTVHSWNBENJGRHQQQCVNIXXNVCOHXYGKPDZIJELWNSJISWIUIDNIGHVTGYEVPBMZXYWVDIKYVEFEKMCTMRUWOWUCJVFUGXLCTSIXTCJNXLKWVHDDDMVPIMEDXYZPCIQPQKLOVERJDUOWRWYCXYKMPPLZFEWPUNZQMOETYFOUXTWTHSYYREOMUQCMITURDSFMMSORLICQTPPRNWEUPJQEXBCZNJJWJCUFKOMQIBJLHHYNCVCQYGIBEZFYGTDSFGQYZUQXYVUDRYTKIXZLSKRVTEFLSNOIWPXTFQMVJMYWFUPTMYHCZCCXOFSHFFSLWRSNVMLFQIPBNXWMTRSVFQSPNZOSULTUNRVQBUEKDKPPNEYGNVMHMEEXYRQGXHWWQEXYGBXLEPKSPQSMCXSNGTQSPWGGOQDJHVRRIELKTIGQQKOMBOYOUVGDHTCOEEWKNHHDCOVQZBVBBFSPQQONXTYYHXZMRODBBBHZWYDODFLPRUCBDHTCRHTUHHXWJMTOSYUUJZIWXYEVBKGFHYCSGLTBOBLVSPCQOWBTRVGSGFTFSDNLTMYOXFUGKMZZSOHXCNGFUGQPELSPSMRTXSTTPIUNLDFIFKCLVSQWLQONLYVNWJHYKBHRIHLNGIHDMDSHEJHRZIGZKUMYZVYOPCBMZYIBTZFYGIDMFFLFDIJKLLVUQPVSLWEQONLYVYPJQFEUUGNKRZYOREXOGGYHXUQPXVWZHXNEYIUTWTLOIQMLUKTKTNFRTJKRSDJTNLDLXGGEXSVRBZCCNHBXZSRGNEFTMBBZYKMGKHJGQVXXQVYOJBDLKSTENMDSJMIOEQUYVNIHIFCBNTRWVVJKXWFNPGMYYCXCXXQPCZSUHCCSLYTUNRQQPKEJDRQYTVERHPLEEWCUQHRWWCDLKKLQHLGGBGZYKYDBSZJWXGLHNYQBEMXBSLRNNUHMJDRTBOHIMDFDMJXVUKFORLITBGZIGXSQDTZSZWGCGDEXPOKICYMDUQSWEXPOFLGJWBTMVQSNTYRXVYKJTFOVYKLVNFOFBLSLGHKDQOIPYLPWZIBIMDFPMMIWLSYWNLHPREHYJDXMFWWCDVKKLCYWWTMOBVRKKEVJXWJQUNTYVECJIBBLLBTGSEBVZNNWUWPCMYKLJFYEWXPRWELPWBVZEKYQRNQBVVQJTSONPPDZDQTQNHLRQMROQNUDVNFDEZCUBFQBOZWLGJOFBIYNNXCIFBBLDQTRZPHHXBSCCTRSQBGZJHRSNTPMZTQBXZQPUJBDRPQHBCETMXVJECFKMGXKCVPILEYWXBJPWQEZTDXGHSIJPXGGKEOGWHDJQGLDBQZWYTMZJHMKBIYGIEHWCEJDRXGVXZNFOZXMJKSQQZIEFWGEJDSMHTSZGHEWBZZQDETUKHCJOUZRUPWMTMIHUMDKOTDLFFUDGPIFBQYPQDVRJLHLVVQPSKCEUKWVDJOYLMBQSHVZUTIVLSXVPFNCJZUSFCYHDXJWWQKVTDQPPHZXJUYTXMHEOWIZNBGUNFJYBJZHOWKFLINYNXXFJJLKYDZQIJCLFXKRQXJEUWPHEBGYJWQHHIPVRMWTHTVVWUDXLNLIMOKJYDYGSZFLWNIQGKDVVUOLFIGUHHYUOWXRKYOURMRKCVOVORSSGUIHYNFZGFMOUIYGLNUGTDYDWKGFFZSTMOKLDTEJLTXVXUWXLMRYLJERLUOKXUKTSXHPJCNZKWFPSMIOSRPRGTLTBGZIVGMXQEPZPCKFDXUVCUGQKEWVFXLCZWPCMWKHKBTNEEOBSMOPBWZHFLGRKQJGEQDFMSHJXLGEDWWXGVPKIJHFCERVKDTDPPJZOLXJYVTQKRQSPRMOCYSLSTCECWBCVPIUHVPISVEUHXLUCZKSBYIQNORKYKGQXRQEGWIBJMXDLTNIHNYRYEXTQPILCWYCXDKZFTPZRRCCUCTSVUWVPFOPBMYMXUYINIQDUPHHUQGYREGOYLWKDVTILVWBOLQBMIDMRHHCDEIYIXEEINRZBDKYWRJCLRJUOXCEUUFTGWHUNSBLGSQTZGPERMGETUEWKCJGKLEDWEOULEGMBKZFLOFDOKTVSKOQKRZEMHSTRUHLFERFWOUKDVVNOJBVFUTHMOQOIYLDPCZCSYLXNPIMIWLLGWDSTRSONWPNZICCEZHFFZJWKGFBNXKPCJTFYHKWOMSORYUKOGZLGXYDJRKPPLSCCMCYHXCIIZNMGSSSKDJEMVVLBWNKDVZUZXLVNXPVQSVYIXIVDIWSSDXTOSLSGFGIXUMWTMOWXEDNMTUVXWCCOIKRSUDBYLXXDKEONXNISGWTSSRBGPVNYFWBLVPJKPYTLHQDTCBZYKFOMRHSMRBVBHMUGBKZJWTCYZXYFICOMZBJVUXGNHBWZIBGHSVRBSCLZFCFXECYGXPWFMTVPDIJDFVERFKLSEMPIVCYFDURQPLXTVFUGXLBTTPREBVMKDITFNMRULMBDBVSSWOUOWFWFIYWFEJYSBIHVWCCOVKRFMVPSGBQHSSGCYXNJRQKWVDVOGLHEYNHYDCKFNULRCGOIYQXPEIPTVGLGVLLXZEYKBSZRQWVLUNXLDZMCESZRFGTKHBYZJRZJHFJGVZCKFIXXOECWEMCFKCYBKHEDWVBJVQQPUTDOUZROJVORSKOCJOFLJRZEVXQQXVGYEZVLEHKIKDGZHZSQVFZRUOYZPOPXQOOLLHHOIMDFKMKSRPODGMOZUHEKVRUQORWPCMZKJEVHLGXHXFEBGZQLDEKLSSRRKCVWRELGNTQZHTRGEOUQVRPBMYMXIESHINCCYWXUGODBLBHHLJKUBTFQXEVJGQGRNMNRORFLOYGQHPTQSBVXWEVJLELPEKMHILGIWECHEKYUZKMEYXNVRWILXSCEICYHXCDIZHMUKSNDJTRYPTCITVYCMQOPIUZJEDSRVJQQLGFBHZCBHHYYXXPIYIFNZNGRSUYTCBWZYQFOJJFUMRBYFHGJOCJEZBDZGIDBXHBUBTFSDUEOMUZCEHYUTCWUOWIMLWKDCTBLKYYWQOYHXORKFOKECIPWMDEXFLSZIFNLCQCBJZUUQKRQSURTPCUIKPTIDREPJCONFYORRQXGEIBPOMGZULKTNFZNHYHWCQVLYVXBDIDWIHCXZQXFNMPRODDVTLBSBRTSSWPOSLKYLQRKRTEOJDHCMIOEPUZISGWPGEFRYYONSCFEZNSTRSZCBBQJERNMOKFBCZERYCODFZIZNNXOVFUOBUZIZNZDIDINGXDVPBUBDGPQCVZZBFVZEERKMTULWTCSLKEWORRDFRYEXVTSBLZNNMBTBSKSFUROMPOJNILEYWIRGNOWJLFNDRYGVTWZBOBWVOTCYSKSTMTTSSVGEQMMYSJEDFDUONLCRWCLLYKXBTWWQDZLKZBZGGFSNMSVNZVOULXLLEUQNDXXLWUHWCXVILGJQTNSIVJQJIYEPILEOYZYNMJVRQNGGIUYMUULMRIXMQVBGZXJBUCFKUVTPOEICEUTHTXSUHONSXHMVNRSQRREJDHYWWCZKLMKGSEDQFNSHFJGCZQPPETDQUSFUHYSNMXQNLSLRNWCJWUHGPCZKLBCXLBYZSISTUSTJGTPGXQDMUPZRBQZGGSEBCZOYLNDZEDFEUNHBRSQEVHUFHJVWKCJGKGBKMOQJIISGFKYOJILGFRGQIJELDCVQECDXTNJMMNMBYDPOSLRTWSJUQWMMRIKTWREEOSTUVDOPLLBCOSVXVOLPBZSQKWENMRQHXJWRZDCYDJBZPZBYNRHFODHTINVGBEYBCSZOBTYZQVJMMDRHYOZIMDFPMEIVGNLKHUFONCSEHYVNLXVEBQPMWZLLGYIYIXZZSIVUVNRQGNIUVFGJREYMOJBDOBTZIRCCJMYOXIUWCEIZBMYTVDTIQPPRZIDSZRZMCWHWGCLKMODDZZTCNRGYOMQOPUUWVNRLGVVEVCUIJUBONEULJKUSTUHXBVJBEMBCEMEUCIUGWPEMHLXUCQKIBEJTRLGFBJZFOCSBTBSISYBFOLGMLQFEFPXNMHDKLVIUEXLVWUQSNCSVPJMLTNMGCSTMEOHHUOMUKHZEHVHTJBMZKCYETYWXDIICLOBXLKNFEYSJQPUNKZYBQBPISBUKOMIVTBNVZJVBEZKVVSXRWJCEXYRQQIDFTHGFGNMHCZPOJLUHWIJUQJJEDQTEBUZJHQOKVBKBJGSVJZOTNYODZPOYXLJCGDFYLXNHIKECJBMLZYXXSRDVONNWXXPEMYPFZSCFDXXJZWIVVXIXRLZNCGOWYREEPNQWHDDORSELNUXMRCJZULFMVNLBJLMOOVXHWOQPSRQTYSXIGESTTZXIEPBKDQTBCZVRQMHOCBUPCQQDBEEYOXXUEJCHOEPOTLSLWFSQBJPEWGDOGFLONVPVYGYHXIQMVNLZOIRSSNPKMMDIYGJRJQUTESDPIGJOXVUYVGPXQPMFTKUVTROBYTELGHREDBEXXWNOTUWPJMUIXTVNDIJOVXZPUCBQZYHDBLSKRSTKEFXOMEGKLPVDCFEGEXKNXGWFYKPYZYZNMOKSIMYWBHMRQIMDFRMGOXYVWWONCPOPUESIDGUKIVEDOKTMDSSHUGBNWRFQOTERQGDHVTQSCSQCBNFKLKMHQPJCDHFYIXEHIPPCXPXGREHNCMJGYOCSUSWRDTCSLGQHUOSXIYRLPIVKXQZQSNROVBGJMNCJWJOWXTXDIVPDMUCTOBHRSENFMMDHTKGFFNMMBIHNDGVNYPJUFCPFLXVCRIXUWMXLGVSURXLUHIDWHFHJOYXKFGIUTURHDJVZZBSEMFUJBVCODWUWQPJDTVTUSXLMTTLDMPHWKBSXIDPNZWJKYVXYOTOWIZYHHHHBEXOTPLZIWPWMDFXTLWQIFRWJCPTWUGIVPEDUZTZMHKTEBCUPKZYIJMTRJWIPFMNOKQUNFCMRKJBXGPVVBKZQJIIESWREJKKFDTLKNRPJLPMDVMYEIQHNCEVOMJBSTFMOZSVONJHGOMJNKGJGYGEZIEZYWLNVIONNMUWMRUETHZHEXUKLGWKQCDNBUZJRMMFJVFBRRWTCDWNBCZBDZZXNMRGPEHNJKUZWCURWBUFJPJFCMYIYYMGIMDFVMOMEPPHIXMHSWCSXVYUNJQWNDCVGLJIEYQRUCKPDUMVGVXIQHNCEVPTJNWZOLRWBLXLQSVPSJVUUTXLTQMIHSMRBVNPIBMZEHCDHZJZTZSHFWOFOMOOZXCFCJYLYFHDJVZZDSCJUEZESIRUGJICSWCCLOKLQTZGQEGOXEGBOWPLCCKMYSGTHSRQMCQLSBIJGOLXUHDLSHISGOHLKQYSRYOWTKBYUHTSNMWINMBUBTZSJFUOLGCYXYEMZCTJGIKFSSRRUCVFCGYZRSQOSXLEEKJHEPOBLYLWGSOBONBCJYYVGESICIHNYTXSLIBFEEEIGQBDDZHRQNRHQYCQZPIFWVNROXVJWFLNEIBHZGQLWVCBHKYWZDJPYWUVSBIZJSJOEYUHTCJHGHMBQSXDITPQRXSOTVJNVFUGXLKJSVCLKOVQEOPMHQPYKTXJEUPPVITQSJXPSNYTEVTRHRODWZCZMKBXVJGQROFDHOSGGNCBZHYTXSFIIVNUKUXMOYTEVFKUTIIWEDWVIJCFKYXWMZEHKDRYOOOSEITWSDEGPLSBDDXVDFUHJLLHBKELSURTSCJWZBJTYWDVQSIPLFNDDOVIUEXLHHBJEMEPMQIVPDOEMUBXZXYWPDNIYJSKFRFYTCONSYHIZNNTGSNYCFGFXTONUCFPGUMRQLOBFKIJGNXTVETEMNKLBZXHWRKMOOXJEURPTPVRUJTPGGOEBJZHBMDWGFHGRQMKZLJMYJHJLGFJKSXWIBEFWGWJYNMUKSSIMQEDUKNMGUKOBGBIPSVIUODZMLNXBEXVJBKOBWZHYCDDTZXCVQCXFYWKMBXZUIZRSCROICRFFJCLKUIIPKZSIQPBNHPJMUUXKGTVIJMCHBCSZKUGNSSBTQSPUGUCDQHBVOWJRONIVUJCECHPJMQZZNKBLGSZNMTSRKSONNBNZRYQDDCRSJXDIWKLNCYQPYGNCVULTNTHSPGUKZXWPNHPQGMQPMPZUNTKRHIXTXNLKUTDEZBOZNLHKIXJEUEPVVNROJMFBXHGFGHWDEBVZBYYODIZICPCNSDQSSLTLTNELOMROQPUGILSLGNCNSRDRJFOMRDCRTQSDEZDSZDMFTUOZXNWEKJHVINJGUEYDSOTOJZIMIOTDHIVJUXBQGNIMVMGJLEFTCMOQXDKFFJUXPOKLJGWHSBZWLKGIGFIBXZBJVPKFNIKINXKXVVFWZSPJUCDVRYMOXLPKMRTOMVPGDETRVLLICDPEZQYCTZSFFYHWWYLKQIMBTXRKPMZIZEJWUMJTRWVNJFDNTBCXXOYIBGHKFVGDOTJGJEOHSFSZKLXNMGCZZRKQJGEDDUNNZZPJRCKVFUIFHTONDGVCYUBEYOWQFYKXTMDHXEEDXJBFYMRFOHWPMNJVKLDDPTUBDXTVIUEXLYOKQDIROHITOEKIHJQQVWJCUQKCGZHXJYNCDBWXYBNZTUOPEMHFXTVNKIIDSYZXPLSMJVPNFJHFCCRFECJETQTNCDMJUESRKVUPBMYDXWTMDISEUYIXSNVITNEPSPNMKBXFGLSIQNEKLGRDJDCMXXGBYBXQSLPQOZHFBPWEDQPBHZJKBHRJQNZVQZFDOYOLRPOTBGZFGCMKKVJGOKBFPWUHEKLYSUXKCNEEZEUWTHJBPQBNFNLQMECONYYVPKENYGXVYVRGPZNUZXXTSNYORNMOPOSLRRWCZVCXDIWUXBKXPRUGEPIUNTKEHTZKCRZNWNYQIVVRFEIIOUBTYDHHFBWRQWJUYLNZKHGGIQJCVZBUFYFDIBZLWSGQGFMBFZYRQUKTJGHHKBPGFBSGGQTLXDFIEGGGRHQMQHKBDFHNWXKHKBGZDVPTOUSTROHIOPMECJTWJWUHIHQPVVVLCKOZTRNTJCXSKTTIZONOQPDHIPIMEEXNJTRIKGDXTZFJEBGZKLJCSZRLFDJDILGZJVXLDONGDSEITVOULXLYZPCDUNRQQHRMGQKQXLSBBBYPSIIOOTNOZXMRFKMBBZYHCXSERZPZRXPVDGRNNOMKCBRZBOHDHPCDBMXVLYVOEFSZSNVHCNMZBRRQQREDDQXEQZKVWIQGPNMWWJTVTUSXLNQUEBKLLDUZNTPLVVPFMQVNBJVDYJQQYZUJFKUVWVIXTULLPKMWTPWETFLKUEESPSVMEOSHITXSWEGGUYJMQGSWNDDLIEXRQDINQGPEYWXHHDMVNLWQFTFGFJELMVDUVXLHQBUKUNMONHUTGFLMNSMLJKUKTIXRZHJFHVZNRDVDQPXXTJEFHTRSETKCQIGZROPZTMXFTUKMBOYUUMBHLUYETMJQBCZWFYUVSCEZHQFHNBKLGSMOHFCGDHYVPWXFWIDYNXLGELGCVJYDUONDIRISOLBKYSTWFENHFCHKLHGFGYGMWSDCZZZVFIPDDHOFKNBMERWCOWFYWJQFPDRQCSTEBVVVKZVUFHTILGTJDFVSRDOLSEEZXMQGUPPXSUUMRLBKYPTLIMMSSJVHEFRTKNMMXMMFEIHSNXUUKMIFLKLVWEYQRVPOGWHCCNKEPVFBHLSNRQRLPEFFXIGPRMQDXHBBMIHJNWGIJJITJKKBFZHYCJDNKCDQKRMOXIWTOVBLTUMNPGMHYNZXCVKEFXCQVKUSFKLINBSBRBSHTBOPEEQBNGESRWSQMHWBFBGRSLXMOTSGITYHMGGGHBIBOZGYIJDIFZEQUYTHJQUSEHFSCVULOKLLTHNBNLGSIPQIUQXSDVPLNLGKIPTNIPMCKJPNCTEWUHGCVPWYNXKDICTDJXYPWDHDTUBLZRTUUUWTDMHWLFQCYMCRSOLSSVGDBNHRPQMBEMDDLBOLZWGCZYIULQSRQTLSNKGUKRRTDBTNJUHYBEZTNVSHLJNDZJNFUKOSPEQWCTKKYOECMECWOPJRIGJUTNKSHHZMGCGWMYVJWFDRRILDRGFXFXFPKWMCQPYYLNSGRNYKWTFPYPUNRWZPPDRFSOSTCSODGRBVRSOXKBMQGFVSFWSCNTESHQGHRBKWQCZMJSUVCETIUGYLKKJGTGNLSYDSTDSVDZXLHSWVYROQLUEEDZYDWYOGDCONLUNEHDYGQHPIQUVNWOMVMOIIDNHILINGOXBEYKPNGRQDKTHKLICJPBYZKWPOTLSYWNPGUKKEYUJMNNXSBHFBNZVYBFDQNXGVISZXXMGFOQDLFHIXSEREPQZPCEDGTMCOGFUCVMUYZQRNQHVMTJLNDFRBSDEYKELRTUWRLQNKEWDRDLGONQWMFTSHQPFNMVUUTXLQQTMCNJFZHHFTGTGHTUMCWZDIFILDYPWRCBODXRMQORYQIDUPTEBWSSXBVLRVSHSDGOSNWXTRKQJGEIDMXWSORLSSBMZOTUCLRRJQUJEGDLSQJOKNPJYMFDDWHHUSDRVDCOMPNORGPGKRNRKTOQQQCGVHBOQZOSHTCRFJQUHELBIZGRQWJCUPKJIEXPJMYXBCFNJUHDHLISSRRECUCZGOBYGKLUHYMEVKYIKQLNNNVJPJFWTMIHOMXRVFOBFLSSGRIBCQSSZBQLEGBGWONFCKEIIGBHYEQLCQZCBNHPOQXQXHFEMHGPRMQRXHSBWIHGPJHITONCIDCYYBWBDMSNLEOFKEJZQLDYBDZTEDJCLZNPFYIFIDMNIWVGCIIKYBCSJEGWIQJLHGIHPETTKDGFETVRVVYQJNULVWOJQJJRBJQZMNPCISJYGCOZLPFDIEJCHZCSJMPMSMLEFNGXTESKPQNRWGHSUPKNDQBGZTDHPOILETWSOFDDUGRTPJQJQPUGKJISERHECOMKKCZOCVEDVRVJOROBTZTYSCDWUSNMQQNMUHITGYDEUFMSHRCVCIYPWLGWSCYOQMRRVTIJYQJNUFVMFJLRJDOISCOTLUHBTUMRJQUIEUDZVCJYEIWNBVZCCGBYHKUVTTOSQQVWZHSJGRDLXDISTUCKOVLFOZKEYDWHOJBNOONQIJHQPOQLPTWSCEQOBVMOPJSUDVVNEWXQPNMYVOMJYEWNGLKHQMGYHKDJKDIPEVBIOZJFVYONPJOSQPVMRQJQFNGDVOMJIFTFXGRYWUYXPFZSEGTHSOQBBWXHCUFNZEVBYZJEGKFIMDFDMVECWPICFPYDUQJYTRILULFKGVTWFLSPYXMOITINMIVGYCVQBNYQVCGJNXZWBGOSXGSDDHJNGGKHJGQGSPEBHLXBYFVONXHUIIRFFIGNNXFZFEIYINCEUWUBKZGKGLGKIDTVTOXWHPCJVYEICDIDLEWKKVJGOBHEBYEHEPSSDQYYCGDHJRIQEVEGDQIDZGCWIPSYIIDNMIZDLPNRBKGPXNVERFNBYXPVVXRZSQPNMWVTXJQWROWLISMONISIBGHUBTYCHGGMXCSQRWYRMMIKTGIMCETWSJJZFLSQZOYBGFGFBJZDOHYFYIXHNXKFGZPGSJKONLCDIVPQISVRBECMOELYYCDGTBVXVYJSQTFGOHLVQTJCHEQCNBMCRKHUJSXBFZOYLZDURCJLGTKNPJGFSFQPRNYKUVTDOOMTZFIHRWFUHVIFWCCLLYJXUZIJWIZUJOQXIOMZRIQPTUZKSVRUOMGTLNIHHQITCKXIYJDHPOILEIWCGGPXNGKYUXFWJSSWHFNSTRSICFYMXOSPJUHLJDTBDZEXOMWODNUYLPFUONUFKSZZDGPSZZXNOGLUYGOWRBULOBWBOXERQPSLUTESHLGTQTKRLKIYCXWRUCOGBYHBGBIJSFTSOQZBJCHLBVZQJGSWFTWSDYGYLCXWZDOBROOBCZXFDHUSIREZCMBHLYIGEFIRUPEICKQZCLHKCLTZGQHSLKUVZTGFWDVSEMTQONLBVCEJTXONGLSHCMGJYIOGKRTQSNEIDGFCLKVEJOYJXDGOKRQIMDFSMMNDLWRSTMRYBSZTJFUVFDHPCNBBBCFFVRKNKUHTMNMWYDMHEJHDZJOUKWMCJKLLSPSEKNSNJTKSJGGYPOISLKUJZBTXCTIUQMRNTGSMYTEEHYPRWJBVGFSVIDQNSUPTMJHECEHQBMUPYOBQZNMXIDEJRFQWRMFULUMUXEGZRNVXUOXWVIMDFYMDKKDCQZHIPJUHHDJSVTFLOKLJTOMCVQXTHCSNJMKJTHORQRJQUTESDLSEJDLVXTIUPBEZTUTDXPWZBCZYCXVWKNEKOWFCDCRYGYDXVDIPUPQMHPXWEKECIXWYWWWDHPCYBPUINMVXQQZRZURNMQTUCHKJJGZZEURTNEGIEEVKMTSJYKKIMDFHMVUMVMSRHPWOQQKJSQOJESURTFCMQMLTSUCWYQPEIMFSIMOWOCLNKHFBFWPCXRWPLEDXWSLTXWOCLJKKQINQEXVEYGUNVREOILYLXKWSTLFYNRQXGRCGLCUHHYQWKIMDFYMLTZHLGYMOHUHJHOBGKQUBWBDQSJLXOVZTOXZOOPDBVZRQXQSNRFVMEJLSOBGRGWLDWKUXGXKECWOWJRKKTELKRTMNQRDEOSHJXXOELTPSRSDOOORLQBCXTCYKCYDMZOZPUTIGPLGOZSOOXONQGKDBBZIYECDMSDLGDQNCWPBCZHGYCBGZYYXNDKQDFZHDPNIYVDPISTQXDPZMZDXBGMHISCKRNYLKBEZWSSDTZSZBGBXFYHWBUGIORVCIRKXOUGJHUQQMGVLYJXTZRVBSZNMFMVGPEMHRXEBUKIHMCCDGBJZQNUKDRIMDFBMLVNUKMDURCELNURGGQKVKBVYQOVTDHRZHHIBEWWBBZZRKVIMDFHMVCFVCBPTUONXUHVVHBVHQPNMTVSSJNJOTMOXHMWGKKTTUIEYWXEJIZOCZYPCTFCMPMUVXYVLQHNCWVUWJPSLKFUKSPWEMKSTUPOOLLLWGOOYPWPSUWWILLOTXNIPOCLOWWRQLSLGWQPRPKQRWKFERQVHUCXLKBOYCWNZMRPCNWVYFUQZVPUMXLKBGTNDISLKNSLHSTNLLNNHGCTYSOLSFETLLYCSHLUBNIPEJNFKZRUFXQVXUHCPJBEZVBUWCRWPCMFKOMXDVODHIUKMMCBEZEFSJXFWORPYYVYCNVHVTMIVVKMGEBJPFMSRCHOBXQFBWHZVEIOSUJLRWWCDQKDLMJFSZWEOZXBMZROYOZUJTUBHDSVPNJZNJVGBIZHICLQVYRXQNILHEFBELTMWQUONRFBUVSLKKJGTHQBMRPJQLVZEIROQPCSWCJZUNFDHTFHJZHGXRWZQPPDZMCGUHTUQZZWCLGCNMEKFONEQPUMJDKPJGBPUTIMVBZFRFTBLZJFWZFFYIXMNXBCPZDEGWHKIJIBVZKSKQWNDIVPLJYHWWVMJHMUGGUHUIZIMDFSMINKNNUSSKLVZLCCGVPYODTPSQBEPDRYVBBJOBXXXDIHJHZJKFJGRTSENNIGOHNHOSGNMIQGZSBRYCCIXUHNTQOXYQOSVWFMISJVSURXLHFBIHQFNKLIPONMPQZTVVQUPXLNPWNTKVJJEETGVBIZJKDJZFZMRVUEEMQEMOJGUCSQLYGNVLFKGKTLNRJLGSNLPJZWCSEVPCNVXUWXLOMYRYPPNCOHXSGJGTOWJIMDFYMISDIJFDCKLFNDMDTXYXEFVIBWNXPLSCIURRDMLTJRNDFTMBKBJGSQVNORPOXESBBXZXJOWWFRTQSYETDCMJFJKZMZCUVHYWHRQIMDFNMDRGFOQZCMQGNEBSZKUQNWVCBPKLIFUKOEYJWBDXKBIZMQESRRQRCTQEGDPUDCTKFPFDQPLEIXDEVEPPJTBSEDYRHVLZSEQPNNPOWLDUWELTGBTLIEDRTJCONOKLCCGZIMFZVNDYICSGGDBLZFBRMMDGZHZRQWKXZVFIHCFBPXJMXENBLZTYSJDTWHWQYDOSYCOONUDXIPGCNZKWFUFPPGHEQIFYSBRZWNESLCBZYOFBWIVHCNSSNGCLWVYHBLHXPEMOPLXGTGCXTQWDRTQPBRXVMVEUHXLWQXKVNBKBUUHTPTDWMFMCTZSRFJYPQLGRWCXMPKEMBJFIDUZTZLHQZXCVIDQFKGTGRVKGWZPOPLMMWLOOEWZCDQTNDDBJZDOXSNEGHTYSJFKDNMZJERPUOMILNPCHNJKCZZUEXMDQDMTYDDVKLBUXYEHWCKJBJRMDQJSZMGSKDRDNDMXUITEOHLRPMRCJPHGWZTJJVQOWMQCNOYVRKJRTLKPIEETONVVHGKGQPNMMVVUJVMHXXUWWGFEXSQGIYKCVOLORQMJTSHHUNEZHDHQPRKXXQEPJPVXTRQXVZHFOUBLZPSZHLLOKLHTMWWLEDGWRPJLSXYKGHIBUETHVHOMOKOZENPYKNQONMLIBOZVYBJDPFUJQTBLTNWGFQPBCWWYYCXOYIRXXXVLKWTNEWMDOTQWKXUKTJGHVXLSTLKUPMIBQZFGSVQPOOLLJWNRDZQKMMOPJVTCBLZGTMDQPPKBOMRQYVVRSHUHGKKJJCTFEWWDIJJLCEGYOOZDTOHTVNUNCRMPOMBUCVNNXXBTBYNUNQPEKIVJLXKWTTSFYIBFLUXNKPCBMZYLQEVSURXLPXFQCEUCKLFIPEBJZQCFFJIULNXPCHSJWBHDYZCVHNYJIVNQGPJYBVNRQQVYDSZYNJLRVPOORFQGJEDDVGQRZDGTOBRZDOMBQHGJHUZQMJSLUJFRYEXGFWQSHWRQNKGJGYFUMTMSOOZZOOYDWLDTUXKLVNKOMERLETHKMOPXVCEWWUWJIMDFYMKSIIYFXKLVFNIHRXWVEGFVIBZNXHHBRHTMORCVNLURFLOJIMDFQMUBVIEEEGSJPUTLEWGQPMLNKKFTKNIHGZSBINNWONGJTJMFPQMPTXSXCVIUVMORGPHFMHFBEHPDMVIXLBZBIXYSRDMLLLRNIFGGSTRSZCQVNQRHEVJFMSUQPINFELJFFGSRQWEBJLKNEIVGFDIEOTUXKXVWJOEGYDQTHPQDYITEBNZDEMCIZELFBVNBWNWCDJRKONLTXDQCCIZEWFZNLSCPSBXWDIKYRSRJRQXSERHPWQMJRSWZSZDINQPXRRPJNNGKFYWEHIGDWLRFDLGECBRCYLJHFCLRWWXEVLKZLRYTNYRHFTUDCZZZMFBBZJRDYWUUKSYHYGNRFGULTNVHPYDPWHTQEPJEPRQHOWTWNHGCFYOMZYSWYGDQIZUKLVMGTKQUNTPVNIJRJKFLRMTLKMWHCYEDYZXZOICRZBXCYBBXBUXFYUKJTGLDKVVTTZKCFHXPJBBNXQPIEMCEJVFBRRTCEWUBUZBPJDWPKLECIDEZWZKJOMRWDDPMOCMZDUKXGFXYEBWYHJQTHRJZEOBMBOXXRVGMHUQBNYRVTRJDRZGFCYWGFJKXBIEOECWOOJRFHBPCDSNZCSLLURNGOUKHVCDOUEVUKPHQZWUHYRDHTLTZBLBNFSJQZONEYKLIMTMBIZWFSSHJJUMZQGFJHJCNFPJIPMECUYZRVEUHXLOMQKSIWHMZSBWZCJCUYFYUXTZIGECNLGPMOYRMYLBTZIDCVLUNXLZFLSJMMGHRHCGGHYFDSKVIUEXLIBGEHIEKPXVDQMSRWYONVFUGXLEZVCDPIRWHKEVIJTCOLWYWXDJIPLLSQOOUJSCZUEUIQLMERFQGLEUDERTEUKJZEVTEVIWSKMTPSMLGVEEQCOXWYYXNMVCQPIYSUVTBCHFFTJUQQRJYDNTVQIRIEMCVZBQFWFEBWQOBRUPLECBKZJFIWECHEKKYOKYICZEXZUDKEEOHXYLXKWITDZYCODZUCZVJYDJWCOLXYLXNNIEEIFLGDRESNMRVFOOTUSRTQSTESDSZJQOHEDZZSPRNODRQCIZEOFDVNRRCZKDPJWSMLJWYBFZTYSBDOMCXLGENEIUHHMITOYMICFZGEFJGLSEXXJKLLCBPZYKECGPRMQBXYPGPIHNZPDDIQTWNRQMVMYOXQUWVNHZDWSMJIPLSMWJUNYCEZHJFNNIKQKSOPSMOQCNMUFTRRJQUHEQDUXYJBNRKVLDVDBHEXOIMDFNMEOXFVQNCHUHPWGMJSMFFDOPLRBIYCUKVPTCEQUMDWFEDVXLIKEFTHUBWMFDSVCMPLUMBTFTTDHPCFBQTXPVVBSTVTEIPVVDMHWQPNMRVCHJNXPGIZXIFEEOXMTUYWGCILKNZHCJKFCPWTCQMGYMYIDNZGZFYCQGQXUFTBCUHCUQKYSVBTKSJGGJTOYBWLZZMBWXOTVLMQOQRNQRVTRJUKDRDGTTSJPYHNKDJGHHCVQCJZIXMYJLJLSJSESNKNDBZBZBSYNMOESSITPJEGKCGCWYWYGXIOIOMDEJCMYHUBEXJVKVPFWHPJMOZTYOGWCCCZBZUCBVZYGSOLPKMITDCFJHBZJHILIONIEJBLHPXMWOXYGYJICWIGMCSRMUONYSIGGHIEQURSYHWCNWXQEVIWFGDCWHIJEQZHZBCBZLZYIXUONIKVPHULRKQJTFGOJQDGMOZYTYCFQPLCPOLLNMWBETZYEXWFCSZZUJSDOZZUBTYUHGTMRNSBUMDEJCTRNYUKJMQOPHUVVNIRFVEZXFGFEJCUOTRFBIYLNXZQCLGEMOQSZBXZVJESGQBNYPVGIJRHHNENSHMKGFCUHCRRRQQDEIDQZOOXYUGQUWVCFDHYILTKSETHKBGOQPVMIRCSOIYLUHCJRFQSRZGGJJFGMOIQZZDIFBHMXSBRYUCHGBROLKGKLKQBVZBMWJKXEEHHPPPXKVQFNKLQUCYGFYGEDLZKZCTHPBBWUQTIMTUHJCKVPYDLZKZCTCROVXXQBTCOEEUYGQJDWWFCGVKMTDLTMIJQRLTWPJGFOPBCNZKMFYBDQFNPDETWTNVTDOSTSTCSOMGRJPQJQRJNDLUKDTNDCEXLUKTDTYVNBCORZNUMGFBFZMFFSIMDFDMQYFZWDFWKLOCCVEYYERQUUTTJHMPGLQQNDUTRCDOEYLNXCJBFYORZJGNBCLCHSWTBOZSLQHVRCQOMERDMHCSGITSUHHPDGXRSERGQIWEJDDPHXURXGQPONMFVPRQDSPRJBHKBNQVOGGHBVXYJKTODKGWHDHQTLOMCMJMOXIKRFOOVPTPODLVZWNZSCWKBMOKKQPWVUKMJUDPPMRBPOKTSVXTHOCXCKUSYEVPOELHJWUSMKQSNSNOCXLTUSJCTEMEOHDUUSMKESUXSJFJZSXPTZNGFTISUNXNWXGHSYZDWJZTDNHLSEMCOOUURVNGHEUVHUQZTLKFVPFMEJWUSJHYBREJEKFHYUWQPXWHZGLWKDZTBLHDOHPCYXXEWTYXQVCWMBOYVUFZHCTTPUVJPPZOMWLSETTFSGUGKNIBWTSTRZDLMDJWROVXHJJUBZWEIMCJJVDVSSICLRNLOEHFJGSZGHVNYEUUPEHEQGGLVPMWIMDFKMIURQMUCPQZGSREKONJPEENWKLJLESQFNUPYEXWVXQVGBHHQBNYNVFUJFMZGPKLOUHCTUHCMULKKJGTMPKLYXREUVEWIFRCTGKPODLVOWVHQMRCJMOEFZWKHLGBPHFNIKKNXURRMZPCUWVDBFZJIGGFBDBVHSEQCODLKDYTXREXGJEXIFWQCPQKFJCWWUVQENYGFRHTOCPOHNJKJZBXLSQLKBTIUHZDIBHJLXIMDFUMJGXYVWEMOCMIMUHDQFWPOTLSYWQTPNTPWDUTMBBZZWTFBZZHYCFDQJIYNWMQFQSPVRMUVPZDDZPZPBGIKQBVLGEHCQPWUGOCJKDWPDCBULDTSVQGZOTXCJCDYWYKKEVHZOCSPKXFHZJQBKXQPIVPQJIMDFPMTIEIUDEOCNWODBWZQRXSDCPOIBRXFDTVDVWKGIKIJWKOEBPJMUSXLOIBIJWWHONXJBVZGKHVUPTMTHSSFNUZGYDWMTUKLHKFTDDZPZMBQQZGCVYNRGELRFTOGQKVVDUVXLVKSHUZRIMKGGFEBRZUOENGGILYLOVDLGUFEBOUB", encoded)
        assertEquals(a, decoded)
    }
}